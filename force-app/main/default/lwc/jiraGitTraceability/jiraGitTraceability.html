<template>
    <lightning-card title="JIRA & Git Traceability Analyzer" icon-name="custom:custom63">
        
        <!-- Input Section -->
        <div class="slds-p-around_medium">
            <lightning-input 
                label="Enter JIRA Story ID" 
                value={storyId}
                onchange={handleStoryIdChange}
                placeholder="e.g., DEMO-1">
            </lightning-input>
            
            <div class="slds-m-top_small">
                <lightning-button 
                    variant="brand" 
                    label="Analyze Traceability"
                    onclick={handleAnalyze}
                    disabled={isLoading}>
                </lightning-button>
            </div>
        </div>

        <!-- Loading Spinner -->
        <template if:true={isLoading}>
            <lightning-spinner alternative-text="Loading" size="medium"></lightning-spinner>
        </template>

        <!-- Results Section -->
        <template if:true={showResults}>
            <div class="slds-p-around_medium">
                
                <!-- JIRA Story Details -->
                <div class="slds-box slds-m-bottom_medium">
                    <h2 class="slds-text-heading_medium slds-m-bottom_small">ðŸ“‹ JIRA Story Details</h2>
                    <dl class="slds-list_horizontal">
                        <dt class="slds-item_label">Key:</dt>
                        <dd class="slds-item_detail"><strong>{jiraData.key}</strong></dd>
                        
                        <dt class="slds-item_label">Summary:</dt>
                        <dd class="slds-item_detail">{jiraData.summary}</dd>
                        
                        <dt class="slds-item_label">Status:</dt>
                        <dd class="slds-item_detail">
                            <lightning-badge label={jiraData.status}></lightning-badge>
                        </dd>
                        
                        <dt class="slds-item_label">Priority:</dt>
                        <dd class="slds-item_detail">{jiraData.priority}</dd>
                    </dl>
                    
                    <div class="slds-m-top_small">
                        <p><strong>Description:</strong></p>
                        <p class="slds-text-color_weak">{jiraData.description}</p>
                    </div>
                    
                    <div class="slds-m-top_small">
                        <p><strong>Acceptance Criteria:</strong></p>
                        <p class="slds-text-color_weak">{jiraData.acceptanceCriteria}</p>
                    </div>
                </div>

                <!-- Git Commits -->
                <div class="slds-box">
                    <h2 class="slds-text-heading_medium slds-m-bottom_small">
                        ðŸ’» Linked Git Commits ({commitCount})
                    </h2>
                    
                    <template if:true={hasCommits}>
                        <template for:each={gitCommits} for:item="commit">
                            <div key={commit.sha} class="slds-box slds-box_x-small slds-m-bottom_x-small">
                                <p><strong>{commit.message}</strong></p>
                                <p class="slds-text-color_weak">
                                    By {commit.author} on {commit.date}
                                </p>
                            </div>
                        </template>
                    </template>
                    
                    <template if:false={hasCommits}>
                        <p class="slds-text-color_weak">No commits found for this story</p>
                    </template>
                </div>
                
            </div>
        </template>

    </lightning-card>
</template>